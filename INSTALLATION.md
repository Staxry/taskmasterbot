# üì¶ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (SQLite)

## üîß –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python 3.11** –∏–ª–∏ –≤—ã—à–µ
- –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ SSH (–∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä)
- Telegram Bot Token (–ø–æ–ª—É—á–∏—Ç—å —É [@BotFather](https://t.me/BotFather))

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** PostgreSQL –ù–ï —Ç—Ä–µ–±—É–µ—Ç—Å—è! –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **SQLite** - —Ñ–∞–π–ª–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

## üìã –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –ù–∞ Ubuntu/Debian:
```bash
# –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python
sudo apt install python3 python3-pip python3-venv -y

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ git (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sudo apt install git -y
```

### –ù–∞ CentOS/RHEL:
```bash
sudo yum update -y
sudo yum install python3 python3-pip git -y
```

### –ù–∞ Windows:
1. –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Python 3.11+](https://www.python.org/downloads/)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Python –¥–æ–±–∞–≤–ª–µ–Ω –≤ PATH

### –ù–∞ macOS:
```bash
brew install python@3.11
```

## üìÇ –®–∞–≥ 2: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω—É–∂–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /home/your_user  # Linux/macOS
# –∏–ª–∏
cd C:\Users\YourName  # Windows

# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
# git clone your_repository_url task-bot
# –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∞—Ä—Ö–∏–≤ –∏ —Ä–∞—Å–ø–∞–∫—É–π—Ç–µ

cd task-bot
```

## ‚öôÔ∏è –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞:

```bash
cp .env.example .env
nano .env  # –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä
```

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env`:

```env
# 1. TELEGRAM_BOT_TOKEN - –ø–æ–ª—É—á–∏—Ç–µ —É @BotFather
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz

# 2. DATABASE_PATH - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –ë–î (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
DATABASE_PATH=data/task_bot.db

# 3. SESSION_SECRET - –ª—é–±–∞—è —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
SESSION_SECRET=my_super_secret_random_string_12345

# 4. TIMEZONE - –≤–∞—à —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
TIMEZONE=Europe/Kaliningrad
```

### –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å Telegram Bot Token:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º (–≤—ã–±–µ—Ä–∏—Ç–µ –∏–º—è –∏ username –±–æ—Ç–∞)
4. BotFather –ø—Ä–∏—à–ª—ë—Ç –≤–∞–º —Ç–æ–∫–µ–Ω –≤–∏–¥–∞ `1234567890:ABCdefGHIjklMNOpqrsTUVwxyz`
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ —Ñ–∞–π–ª `.env`

## üì¶ –®–∞–≥ 4: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv

# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –µ–≥–æ
# Linux/macOS:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install --upgrade pip
pip install -r requirements_deploy.txt
```

## üë• –®–∞–≥ 5: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ whitelist

–ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º –¥–æ–±–∞–≤—å—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Python (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `add_admin.py`:

```python
import sqlite3

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ
conn = sqlite3.connect('data/task_bot.db')
cur = conn.cursor()

# –î–æ–±–∞–≤—å—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π username –ë–ï–ó @)
cur.execute(
    "INSERT OR IGNORE INTO allowed_users (username, role) VALUES (?, ?)",
    ('your_telegram_username', 'admin')
)

# –î–æ–±–∞–≤—å—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
cur.execute(
    "INSERT OR IGNORE INTO allowed_users (username, role) VALUES (?, ?)",
    ('employee_username', 'employee')
)

conn.commit()
conn.close()
print("‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã!")
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```bash
python3 add_admin.py
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ sqlite3 CLI

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ sqlite3 –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
sudo apt install sqlite3  # Ubuntu/Debian

# –û—Ç–∫—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
sqlite3 data/task_bot.db

# –î–æ–±–∞–≤—å—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ username –Ω–∞ –≤–∞—à Telegram username –ë–ï–ó @)
INSERT INTO allowed_users (username, role) VALUES ('your_telegram_username', 'admin');

# –î–æ–±–∞–≤—å—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
INSERT INTO allowed_users (username, role) VALUES ('employee_username', 'employee');

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ
SELECT * FROM allowed_users;

# –í—ã—Ö–æ–¥
.exit
```

**–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞—à Telegram username **–±–µ–∑ —Å–∏–º–≤–æ–ª–∞ @**.

## üöÄ –®–∞–≥ 6: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate  # Linux/macOS
# –∏–ª–∏
venv\Scripts\activate  # Windows

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
python3 bot.py
```

–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ `Ctrl+C`.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ó–∞–ø—É—Å–∫ —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–ø—Ç–∞ (Linux/macOS)

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x START_BOT.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ
./START_BOT.sh
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –º–µ–Ω—é —Å –æ–ø—Ü–∏—è–º–∏: —Å—Ç–∞—Ä—Ç, —Å—Ç–æ–ø, —Ä–µ—Å—Ç–∞—Ä—Ç, —Å—Ç–∞—Ç—É—Å, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ —Å–µ—Ä–≤–∏—Å.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ systemd (Linux, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
./START_BOT.sh
# –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é 5: "Install as systemd service"
```

–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å –≤—Ä—É—á–Ω—É—é:

```bash
sudo nano /etc/systemd/system/task-bot.service
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:

```ini
[Unit]
Description=Telegram Task Management Bot
After=network.target

[Service]
Type=simple
User=your_user
WorkingDirectory=/home/your_user/task-bot
Environment="PATH=/home/your_user/task-bot/venv/bin"
ExecStart=/home/your_user/task-bot/venv/bin/python3 /home/your_user/task-bot/bot.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

–ó–∞–º–µ–Ω–∏—Ç–µ `your_user` –Ω–∞ –≤–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å:

```bash
sudo systemctl daemon-reload
sudo systemctl enable task-bot
sudo systemctl start task-bot
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:

```bash
sudo systemctl status task-bot
```

–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
# –õ–æ–≥–∏ systemd
sudo journalctl -u task-bot -f

# –õ–æ–≥–∏ –±–æ—Ç–∞
tail -f logs/bot.log
```

## üîß –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –ø–æ username
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start`
4. –ï—Å–ª–∏ –≤—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ whitelist, –±–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç –≥–ª–∞–≤–Ω—ã–º –º–µ–Ω—é

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω **Europe/Kaliningrad (UTC+2)**.

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env`
2. –ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É `TIMEZONE=`:

```env
# –î–ª—è –ú–æ—Å–∫–≤—ã
TIMEZONE=Europe/Moscow

# –î–ª—è –ö–∏–µ–≤–∞
TIMEZONE=Europe/Kiev

# –î–ª—è –ê–ª–º–∞—Ç—ã
TIMEZONE=Asia/Almaty

# –î–ª—è –ú–∏–Ω—Å–∫–∞
TIMEZONE=Europe/Minsk
```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞
sudo systemctl stop task-bot
# –∏–ª–∏ ./START_BOT.sh -> –≤—ã–±–µ—Ä–∏—Ç–µ "Stop bot"
# –∏–ª–∏ Ctrl+C –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω –≤—Ä—É—á–Ω—É—é

# –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ git)
git pull

# –û–±–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
source venv/bin/activate
pip install --upgrade -r requirements_deploy.txt

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
sudo systemctl start task-bot
# –∏–ª–∏ ./START_BOT.sh -> –≤—ã–±–µ—Ä–∏—Ç–µ "Start bot"
# –∏–ª–∏ python3 bot.py
```

## üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –±—ç–∫–∞–ø–æ–≤
mkdir -p backups

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
cp data/task_bot.db backups/task_bot_$(date +%Y%m%d_%H%M%S).db
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (cron):

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ crontab
crontab -e

# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É (–±—ç–∫–∞–ø –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00)
0 3 * * * cp /home/your_user/task-bot/data/task_bot.db /home/your_user/task-bot/backups/task_bot_$(date +\%Y\%m\%d).db
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞
sudo systemctl stop task-bot

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ë–î –∏–∑ –±—ç–∫–∞–ø–∞
cp backups/task_bot_20250117.db data/task_bot.db

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
sudo systemctl start task-bot
```

## üõ°Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —Ñ–∞–π–ª `.env`** –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö
2. **–ó–∞—â–∏—Ç–∏—Ç–µ —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**:
   ```bash
   chmod 600 data/task_bot.db
   ```
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ **—Ñ–∞–µ—Ä–≤–æ–ª** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ```bash
   sudo ufw allow OpenSSH
   sudo ufw enable
   ```
4. –†–µ–≥—É–ª—è—Ä–Ω–æ **–æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É**:
   ```bash
   sudo apt update && sudo apt upgrade -y
   ```
5. –î–µ–ª–∞–π—Ç–µ **—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
tail -50 logs/bot.log

# –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä (live)
tail -f logs/bot.log

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
grep ERROR logs/bot.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:
```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status task-bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
ps aux | grep bot.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
ls -lh data/task_bot.db
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
sqlite3 data/task_bot.db

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—ã
.tables

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
SELECT * FROM users;

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∑–∞–¥–∞—á–∏
SELECT id, title, status, due_date FROM tasks;

# –í—ã—Ö–æ–¥
.exit
```

## ‚ùì –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å `TELEGRAM_BOT_TOKEN` –≤ `.env`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
   ```bash
   ls -la .env
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   tail -100 logs/bot.log
   ```
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ:
   ```bash
   which python3
   ```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
   ```bash
   ls -la data/
   ```
2. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤—Ä—É—á–Ω—É—é:
   ```bash
   mkdir -p data
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_PATH` –≤ `.env`

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à Telegram username –¥–æ–±–∞–≤–ª–µ–Ω –≤ `allowed_users`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω:
   ```bash
   ps aux | grep bot.py
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞ "database is locked":
1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –±–æ—Ç–∞:
   ```bash
   ps aux | grep bot.py
   kill -9 PID
   ```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –∑–∞–ø—É—â–µ–Ω

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞ –≤ `logs/bot.log`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ systemd: `sudo journalctl -u task-bot -n 100`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ `.env`
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º:
   ```bash
   ls -la data/task_bot.db
   ls -la .env
   ```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å PostgreSQL –Ω–∞ SQLite

**–í–ê–ñ–ù–û:** –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å–æ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ –±–æ—Ç–∞ —Å PostgreSQL!

–ï—Å–ª–∏ –≤—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ –±–æ—Ç–∞ –≤–ø–µ—Ä–≤—ã–µ, –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª.

#### –®–∞–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å PostgreSQL

1. **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ PostgreSQL** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å):
   ```bash
   # –≠–∫—Å–ø–æ—Ä—Ç —Ç–∞–±–ª–∏—Ü
   pg_dump -h localhost -U postgres -d taskbot -t users --data-only > users.sql
   pg_dump -h localhost -U postgres -d taskbot -t tasks --data-only > tasks.sql
   pg_dump -h localhost -U postgres -d taskbot -t allowed_users --data-only > allowed_users.sql
   ```

2. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –±–æ—Ç–∞**:
   ```bash
   sudo systemctl stop task-bot
   ```

3. **–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥**:
   ```bash
   git pull
   pip install --upgrade -r requirements_deploy.txt
   ```

4. **–û–±–Ω–æ–≤–∏—Ç–µ `.env`**:
   ```bash
   # –ó–∞–º–µ–Ω–∏—Ç–µ DATABASE_URL –Ω–∞ DATABASE_PATH
   # –ë—ã–ª–æ: DATABASE_URL=postgresql://...
   # –°—Ç–∞–ª–æ: DATABASE_PATH=data/task_bot.db
   ```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã** (–µ—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å SQLite –ë–î —Å–æ —Å—Ç–∞—Ä–æ–π —Å—Ö–µ–º–æ–π):
   ```bash
   python3 migrate_to_timestamp.py
   ```

6. **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ SQLite** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö SQL —Ñ–∞–π–ª–æ–≤ –≤ –Ω–æ–≤—É—é SQLite –ë–î.

7. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞**:
   ```bash
   sudo systemctl start task-bot
   ```

#### –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å PostgreSQL

- ‚úÖ SQLite –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∏–ø `timestamp` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –¥–∞—Ç
- ‚úÖ –í—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ SQLite —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- ‚ö†Ô∏è PostgreSQL –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π SQLite –±–∞–∑—ã —Å–æ —Å—Ç–∞—Ä–æ–π —Å—Ö–µ–º–æ–π

**–í–ê–ñ–ù–û:** –ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ –°–¢–ê–†–û–ô —Å—Ö–µ–º–æ–π (–ø–æ–ª—è —Å —Ç–∏–ø–æ–º TEXT –≤–º–µ—Å—Ç–æ timestamp), –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é!

#### –ö–∞–∫ —É–∑–Ω–∞—Ç—å, –Ω—É–∂–Ω–∞ –ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ö–µ–º—É –≤–∞—à–µ–π –±–∞–∑—ã
sqlite3 data/task_bot.db ".schema tasks"

# –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ "due_date TEXT" - –Ω—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è
# –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ "due_date timestamp" - –º–∏–≥—Ä–∞—Ü–∏—è –ù–ï –Ω—É–∂–Ω–∞
```

#### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

1. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞**:
   ```bash
   sudo systemctl stop task-bot
   # –∏–ª–∏
   pkill -f bot.py
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ë–î**:
   ```bash
   cp data/task_bot.db data/task_bot.db.backup_manual
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏**:
   ```bash
   python3 migrate_to_timestamp.py
   ```

   –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   - –°–æ–∑–¥–∞—Å—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Å timestamp
   - –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å —Ç–∏–ø–æ–º `timestamp`
   - –°–∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
   - –û—Ç–∫–ª—é—á–∏—Ç/–≤–∫–ª—é—á–∏—Ç foreign key constraints

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
   ```bash
   sqlite3 data/task_bot.db "SELECT * FROM tasks LIMIT 1"
   ```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞**:
   ```bash
   sudo systemctl start task-bot
   # –∏–ª–∏
   python3 bot.py
   ```

6. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**:
   ```bash
   tail -f logs/bot.log
   ```

#### –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏:

–ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é:

```bash
# –ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
ls -lh data/task_bot.db.backup_*

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ë–î
cp data/task_bot.db.backup_YYYYMMDD_HHMMSS data/task_bot.db

# –ò–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä—É—á–Ω—É—é –∫–æ–ø–∏—é
cp data/task_bot.db.backup_manual data/task_bot.db
```

#### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç migrate_to_timestamp.py:

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
- ‚úÖ –û—Ç–∫–ª—é—á–∞–µ—Ç foreign key constraints
- ‚úÖ –ü–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã —Å —Ç–∏–ø–æ–º `timestamp`
- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ø–æ—Ç–µ—Ä—å
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ foreign key constraints
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏—é —Å—Ö–µ–º—ã –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π

## ‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ SQLite

- ‚úÖ **–ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏** –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ–π –±—ç–∫–∞–ø** - –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `task_bot.db`
- ‚úÖ **–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å** - –ø–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ —Ñ–∞–π–ª –ë–î –Ω–∞ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä
- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞** - –≥–æ—Ç–æ–≤–æ –∑–∞ 5 –º–∏–Ω—É—Ç
- ‚úÖ **–ù–∏–∑–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–º –∂–µ–ª–µ–∑–µ
- ‚úÖ **–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∫–æ–º–∞–Ω–¥** –¥–æ 50 —á–µ–ª–æ–≤–µ–∫
- ‚úÖ **–ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - –Ω–µ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å PostgreSQL

---

**–ì–æ—Ç–æ–≤–æ!** –í–∞—à –±–æ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö SQLite. üéâ
