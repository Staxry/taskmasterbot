# Развертывание бота на сервере

## Использование .env файла для токена

Бот автоматически читает токен и другие настройки из файла `.env` в корне проекта.

### Шаг 1: Создайте файл .env на сервере

```bash
# Скопируйте пример файла
cp .env.example .env

# Отредактируйте файл и добавьте свой токен
nano .env
```

### Шаг 2: Заполните .env файл

Откройте `.env` и укажите свои значения:

```bash
# Токен вашего бота (получите у @BotFather)
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz

# База данных (по умолчанию data/task_bot.db)
DATABASE_PATH=data/task_bot.db

# Секретный ключ (любая случайная строка)
SESSION_SECRET=my_random_secret_key_12345

# Часовой пояс (опционально)
TIMEZONE=Europe/Kaliningrad
TIMEZONE_ABBR=КЛД

# Уровень логирования (опционально)
LOG_LEVEL=INFO
```

### Шаг 3: Проверьте права доступа

```bash
# .env файл должен быть доступен только владельцу
chmod 600 .env

# Убедитесь, что .env НЕ добавлен в git
cat .gitignore | grep .env
```

### Шаг 4: Запустите бота

```bash
# Используйте скрипт для управления ботом
./START_BOT.sh
```

## Как это работает

1. При запуске бот читает файл `app/config.py`
2. `config.py` выполняет `load_dotenv()`, который загружает `.env`
3. Токен берется из переменной окружения: `BOT_TOKEN = os.getenv('TELEGRAM_BOT_TOKEN')`

## Приоритет источников настроек

1. **Переменные окружения** (установленные в системе)
2. **Файл .env** (в корне проекта)
3. **Значения по умолчанию** (в коде)

Это означает, что если переменная установлена в системе, она имеет приоритет над `.env` файлом.

## Безопасность

⚠️ **ВАЖНО:**
- Никогда не добавляйте `.env` в git
- Файл `.env` уже указан в `.gitignore`
- Используйте `.env.example` как шаблон
- Устанавливайте права `chmod 600 .env`

## Пример на сервере Ubuntu

```bash
# 1. Перейдите в папку проекта
cd /home/user/telegram-task-bot

# 2. Создайте .env из примера
cp .env.example .env

# 3. Отредактируйте и добавьте токен
nano .env

# 4. Установите правильные права
chmod 600 .env

# 5. Запустите бота
./START_BOT.sh
```

## Проверка конфигурации

Чтобы проверить, что токен загружается правильно:

```bash
# Запустите бота вручную и проверьте логи
python bot.py

# В логах должно появиться:
# "Bot startup complete! @YourBotName"
```

Если бот не запускается:
- Проверьте, что файл `.env` находится в корне проекта
- Проверьте, что `TELEGRAM_BOT_TOKEN` указан правильно
- Проверьте логи в `logs/bot.log`

## Альтернативный способ (системные переменные)

Вместо `.env` файла можно использовать системные переменные окружения:

```bash
# Добавьте в ~/.bashrc или ~/.profile
export TELEGRAM_BOT_TOKEN="1234567890:ABCdefGHIjklMNOpqrsTUVwxyz"
export TIMEZONE="Europe/Kaliningrad"
export TIMEZONE_ABBR="КЛД"

# Перезагрузите профиль
source ~/.bashrc

# Запустите бота
python bot.py
```
